"use strict";!function(t){if(document instanceof HTMLDocument!=!1||document instanceof XMLDocument!=!1&&document.createElement("div")instanceof HTMLDivElement!=!1){var e=document.contentType||"";if(!/^image\/|^text\/plain/.test(e)){var n=t.vAPI=t.vAPI||{},i=t.chrome;if(!n.sessionId){t.Set instanceof Function?t.createSet=function(){return new Set}:t.createSet=function(){var t=function(){this.clear()};t.prototype={add:function(t){return void 0===this._set[t]&&(this._set[t]=!0,this.size+=1),this},clear:function(){this._set=Object.create(null),this.size=0,this._values=void 0,this._i=void 0,this.value=void 0,this.done=!0},delete:function(t){return void 0!==this._set[t]&&(delete this._set[t],this.size-=1,!0)},has:function(t){return void 0!==this._set[t]},next:function(){return this._i<this.size?this.value=this._values[this._i++]:(this._values=void 0,this.value=void 0,this.done=!0),this},polyfill:!0,values:function(){return this._values=Object.keys(this._set),this._i=0,this.value=void 0,this.done=!1,this}};var e=function(){this.clear()};return e.prototype={add:function(t){-1===this._set.indexOf(t)&&this._set.push(t)},clear:function(){this._set=[],this._i=0,this.value=void 0,this.done=!0},delete:function(t){var e=this._set.indexOf(t);return-1!==e&&(this._set.splice(e,1),!0)},has:function(t){return-1!==this._set.indexOf(t)},next:function(){return this._i===this._set.length?(this.value=void 0,this.done=!0):(this.value=this._set[this._i],this._i+=1),this},polyfill:!0,values:function(){return this._i=0,this.done=!1,this}},Object.defineProperty(e.prototype,"size",{get:function(){return this._set.length}}),function(n){return"object"===n?new e:new t}}();n.lock=function(){1},n.unlock=function(){1},n.executionCost={start:function(){},stop:function(){}},n.executionCost.start(),n.randomToken=function(){return String.fromCharCode(Date.now()%26+97)+Math.floor(982451653*Math.random()+982451653).toString(36)},n.sessionId=n.randomToken(),n.chrome=!0,n.setTimeout=n.setTimeout||t.setTimeout.bind(t),n.shutdown={jobs:[],add:function(t){this.jobs.push(t)},exec:function(){for(var t;t=this.jobs.pop();)t()},remove:function(t){for(var e;-1!==(e=this.jobs.indexOf(t));)this.jobs.splice(e,1)}},n.messaging={port:null,portTimer:null,portTimerDelay:1e4,channels:Object.create(null),channelCount:0,pending:Object.create(null),pendingCount:0,auxProcessId:1,shuttingDown:!1,shutdown:function(){this.shuttingDown=!0,this.destroyPort()},disconnectListener:function(){this.port=null,n.shutdown.exec()},disconnectListenerCallback:null,messageListener:function(t){if(t)if(!0!==t.broadcast||t.channelName){if(t.auxProcessId){var e=this.pending[t.auxProcessId];if(delete this.pending[t.auxProcessId],delete t.auxProcessId,e)return this.pendingCount-=1,void e(t.msg)}var n=this.sendToChannelListeners(t.channelName,t.msg);if(void 0!==t.mainProcessId){var i=this.connect();null!==i&&i.postMessage({mainProcessId:t.mainProcessId,msg:n})}}else for(var s in this.channels)this.sendToChannelListeners(s,t.msg)},messageListenerCallback:null,portPoller:function(){if(this.portTimer=null,null!==this.port&&(0!==this.channelCount||0!==this.pendingCount))return this.portTimer=n.setTimeout(this.portPollerCallback,this.portTimerDelay),void(this.portTimerDelay=Math.min(2*this.portTimerDelay,36e5));this.destroyPort()},portPollerCallback:null,destroyPort:function(){null!==this.portTimer&&(clearTimeout(this.portTimer),this.portTimer=null);var t=this.port;if(null!==t&&(t.disconnect(),t.onMessage.removeListener(this.messageListenerCallback),t.onDisconnect.removeListener(this.disconnectListenerCallback),this.port=null),0!==this.channelCount&&(this.channels=Object.create(null),this.channelCount=0),0!==this.pendingCount){var e,n=this.pending;for(var i in this.pending=Object.create(null),this.pendingCount=0,n)"function"==typeof(e=n[i])&&e(null)}},createPort:function(){if(this.shuttingDown)return null;null===this.messageListenerCallback&&(this.messageListenerCallback=this.messageListener.bind(this),this.disconnectListenerCallback=this.disconnectListener.bind(this),this.portPollerCallback=this.portPoller.bind(this));try{this.port=i.runtime.connect({name:n.sessionId})||null}catch(t){this.port=null}return null!==this.port&&(this.port.onMessage.addListener(this.messageListenerCallback),this.port.onDisconnect.addListener(this.disconnectListenerCallback)),this.portTimerDelay=1e4,null===this.portTimer&&(this.portTimer=n.setTimeout(this.portPollerCallback,this.portTimerDelay)),this.port},connect:function(){return null!==this.port?this.port:this.createPort()},send:function(t,e,n){this.sendTo(t,e,void 0,void 0,n)},sendTo:function(t,e,i,s,o){this.pendingCount>25&&n.shutdown.exec();var r,h=this.connect();null!==h?(o&&(r=this.auxProcessId++,this.pending[r]=o,this.pendingCount+=1),h.postMessage({channelName:t,auxProcessId:r,toTabId:i,toChannel:s,msg:e})):"function"==typeof o&&o()},addChannelListener:function(t,e){if("function"==typeof e){var n=this.channels[t];void 0!==n&&-1!==n.indexOf(e)||(void 0===n?(this.channels[t]=[e],this.channelCount+=1):n.push(e),this.connect())}},removeChannelListener:function(t,e){if("function"==typeof e){var n=this.channels[t];if(void 0!==n){var i=n.indexOf(e);-1!==i&&(n.splice(i,1),0===n.length&&(delete this.channels[t],this.channelCount-=1))}}},removeAllChannelListeners:function(t){void 0!==this.channels[t]&&(delete this.channels[t],this.channelCount-=1)},sendToChannelListeners:function(t,e){var n=this.channels[t];if(void 0!==n){for(var i,s=0,o=n.length;s<o&&void 0===(i=n[s](e));s++);return i}}},n.shutdown.add(function(){n.messaging.shutdown(),delete window.vAPI}),n.executionCost.stop("vapi-client.js")}}}}(this);